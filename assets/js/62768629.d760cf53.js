"use strict";(self.webpackChunkdocusaurus_docs=self.webpackChunkdocusaurus_docs||[]).push([[412],{9984:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>d});var t=s(5893),i=s(1151);const l={title:"Setup",sidebar_position:2},r=void 0,a={id:"Tyle/setup",title:"Setup",description:"Where Can I Find the Code?",source:"@site/docs/Tyle/setup.md",sourceDirName:"Tyle",slug:"/Tyle/setup",permalink:"/documents/docs/Tyle/setup",draft:!1,unlisted:!1,editUrl:"https://github.com/mimir-org/documents/tree/main/docs/Tyle/setup.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Setup",sidebar_position:2},sidebar:"tyleDocs",previous:{title:"Introduction",permalink:"/documents/docs/Tyle/intro"},next:{title:"Current state of the code base",permalink:"/documents/docs/Tyle/current-state"}},o={},d=[{value:"Where Can I Find the Code?",id:"where-can-i-find-the-code",level:2},{value:"Setup",id:"setup",level:2},{value:"Database",id:"database",level:3},{value:"Application",id:"application",level:3},{value:"App settings",id:"app-settings",level:4},{value:"Run locally",id:"run-locally",level:4},{value:"Create a user",id:"create-a-user",level:4},{value:"Enable all features in Tyle",id:"enable-all-features-in-tyle",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"where-can-i-find-the-code",children:"Where Can I Find the Code?"}),"\n",(0,t.jsxs)(n.p,{children:["The code for Tyle can be found here ",(0,t.jsx)(n.a,{href:"https://github.com/mimir-org",children:"https://github.com/mimir-org"})," under the mimir-org repository. The project can be\ncloned\nto your machine with ",(0,t.jsx)(n.code,{children:"git@github.com:mimir-org/<repository>.git"})," via SSH or ",(0,t.jsx)(n.code,{children:"gh repo clone mimir-org/<repository>"}),"\nwith ",(0,t.jsx)(n.a,{href:"https://cli.github.com/",children:"GitHub CLI"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"git clone git@github.com:mimir-org/tyle.git\n"})}),"\n",(0,t.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,t.jsx)(n.h3,{id:"database",children:"Database"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Download and install ",(0,t.jsx)(n.a,{href:"https://www.docker.com/",children:"Docker"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Create a new .yaml file and paste the following code."}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"docker-compose.yaml"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"version: \"3.8\"\n\nservices:\n  mssql:\n    image: \"mcr.microsoft.com/mssql/server:2017-CU8-ubuntu\"\n    hostname: 'mssql'\n    container_name: mssql\n    ports:\n      - '127.0.0.1:1433:1433'\n    volumes:\n      - mssql:/var/opt/mssql\n    environment:\n      - ACCEPT_EULA=Y\n      - MSSQL_SA_PASSWORD=P4ssw0rd1\n      - MSSQL_PID=Standard\n    networks:\n      - type_library_network\n    restart: unless-stopped\n\nvolumes:\n  mssql:\n    driver: local\n\nnetworks:\n  type_library_network:\n    driver: bridge\n"})})]}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Place this yaml file as shown below:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\ud83d\udcc1 mimirorg (this can be renamed to whatever you want)\n\u251c\u2500\u2500 \ud83d\udcc1 tyle\n\u2502   \u2514\u2500\u2500 \ud83d\udcc1 etc\n\u2514\u2500\u2500 \ud83d\udc0b docker-compose.yaml\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsx)(n.li,{children:"Then run the docker-compose file from the command line. Use docker-compose up -d from the folder where the file is\nlocated."}),"\n",(0,t.jsx)(n.li,{children:"Once it is up and running, you should be able to access the database using our database management\napplication of choice:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"- DataSource=mssql\n- Host=localhost\n- Port=1433\n- User=sa\n- Password=P4ssw0rd1\n"})}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Docker container list"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'CONTAINER ID   IMAGE                                            COMMAND                   CREATED         STATUS         PORTS                           NAMES\nd914b6d4d538   mcr.microsoft.com/mssql/server:2017-CU8-ubuntu   "/opt/mssql/bin/sqls\u2026"    9 seconds ago   Up 7 seconds   127.0.0.1:1433->1433/tcp        mssql\n'})})]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["If you are unfamiliar using docker command line tool. An option is to use\nthe ",(0,t.jsx)(n.a,{href:"https://www.docker.com/products/docker-desktop/",children:"docker desktop application"})," to manage docker containers."]})}),"\n",(0,t.jsx)(n.h3,{id:"application",children:"Application"}),"\n",(0,t.jsx)(n.p,{children:"Tyle depends on the database to run."}),"\n",(0,t.jsx)(n.h4,{id:"app-settings",children:"App settings"}),"\n",(0,t.jsxs)(n.p,{children:["Before we can run tyle server you need to create a local app settings file. Because of gitignore this file need to be\nnamed ",(0,t.jsx)(n.strong,{children:"appsettings.Development.json"}),". Use the existing appsettings.json file combined with the environment variables\nsection\nin the ",(0,t.jsx)(n.a,{href:"intro",children:"introduction page"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Path to where the file should be created:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"src/server/Tyle.Api/appsettings.Development.json"})}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"run-locally",children:"Run locally"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Tyle server is an ",(0,t.jsx)(n.a,{href:"https://dotnet.microsoft.com/en-us/",children:".NET"})," application, so you need to build it\nbefore you run it. This can be done via the IDE or using the command line as shown below. The ",(0,t.jsx)(n.code,{children:"dotnet run"})," command\nbuilds and runs the application."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"dotnet run <project name>\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:["Tyle client is a ",(0,t.jsx)(n.a,{href:"https://react.dev/",children:"React"})," application using NPM. So navigate to the client folder and run this\ncommand to install all node modules required:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm i\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Then you run the build command followed by the start command to launch the application. These steps can also be setup\nusing your IDE."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run build\nnpm run start\n"})}),"\n",(0,t.jsx)(n.h4,{id:"create-a-user",children:"Create a user"}),"\n",(0,t.jsx)(n.p,{children:"The first thing you need to do after installation is to start the tyle backend, the database, and the frontend. Then\nregister a new user through the frontend. After registration, you will be told to wait for an email, which will never\ncome, because it is located here:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Make sure to have the database, client and server running."}),"\n",(0,t.jsx)(n.li,{children:"Register a new user through the client logon screen."}),"\n",(0,t.jsx)(n.li,{children:"At the end of registration you will need to validate your email. Since this is in a local environment the mail will\nbe stored in this path:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"/mimirorg/typelibrary/src/server/Tyle.Api/bin/Debug/net7.0/Data/Mail\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsx)(n.li,{children:"Copy the code from the txt-file generated in the mail folder. And you should be able to log in."}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"It may be useful to sort by last modified so that the last email you received is at the top."})}),"\n",(0,t.jsx)(n.h3,{id:"enable-all-features-in-tyle",children:"Enable all features in Tyle"}),"\n",(0,t.jsxs)(n.p,{children:["I order to enable all features you need to assign the administrator role to your newly created user. This is done\nthrough the ",(0,t.jsx)(n.strong,{children:"MimirorgAuthentication"})," database. You will have to create a new connection between the users-table and\nthe roles-table."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Query the AspNetUsers table. Save your ID."}),"\n",(0,t.jsx)(n.li,{children:"Query the AspNetRoles table. Save the Administrator ID."}),"\n",(0,t.jsx)(n.li,{children:"Insert both IDs into the AspNetUserRoles table. Now you have enabled administrator role to your user."}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"i-need-to-clean-up-my-local-database-how-can-i-do-this",children:"I need to clean up my local database, how can I do this?"}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.p,{children:"Tyle kill script"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"----------------------------------------------------------------------\n--Script som kobler fra alt og alle som er tilkoblet\n--Deretter slettes databasen\nUSE [master];\nDECLARE @kill varchar(8000) = '';\nSELECT @kill = @kill + 'kill ' + CONVERT(varchar(5), session_id) + ';'\nFROM sys.dm_exec_sessions\nWHERE database_id = db_id('Tyle')\nEXEC(@kill);\nDROP DATABASE Tyle\nCREATE Database Tyle\n---------------------------------------------------------------------\n----------------------------------------------------------------------\n"})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.p,{children:"MimirorgAuthentication kill script"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"---------------------------------------------------------------------\n----------------------------------------------------------------------\n--Script som kobler fra alt og alle som er tilkoblet\n--Deretter slettes databasen\nUSE [master];\nDECLARE @kill varchar(8000) = '';\nSELECT @kill = @kill + 'kill ' + CONVERT(varchar(5), session_id) + ';'\nFROM sys.dm_exec_sessions\nWHERE database_id = db_id('MimirorgAuthentication')\nEXEC(@kill);\nDROP DATABASE MimirorgAuthentication\nCREATE Database MimirorgAuthentication\n---------------------------------------------------------------------\n----------------------------------------------------------------------\n"})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.p,{children:"ModelBuilder kill script"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"---------------------------------------------------------------------\n----------------------------------------------------------------------\n--Script som kobler fra alt og alle som er tilkoblet\n--Deretter slettes databasen\nUSE [master];\nDECLARE @kill varchar(8000) = '';\nSELECT @kill = @kill + 'kill ' + CONVERT(varchar(5), session_id) + ';'\nFROM sys.dm_exec_sessions\nWHERE database_id = db_id('ModelBuilder')\nEXEC(@kill);\nDROP DATABASE ModelBuilder\nCREATE Database ModelBuilder\nINSERT INTO [ModelBuilder].[dbo].[CollaborationPartner] VALUES ('Aibel', 'aibel.com', 0, 'rdf.aibel.com');\n---------------------------------------------------------------------\n--USE master\n--GO\n--xp_readerrorlog 0, 1, N'Server is listening on' \n--GO\n"})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.p,{children:"Nuclear option (kill all)"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"----------------------------------------------------------------------\n--Script som kobler fra alt og alle som er tilkoblet\n--Deretter slettes databasen\nUSE [master];\nDECLARE @kill varchar(8000) = '';\nSELECT @kill = @kill + 'kill ' + CONVERT(varchar(5), session_id) + ';'\nFROM sys.dm_exec_sessions\nWHERE database_id = db_id('Tyle')\nEXEC(@kill);\nDROP DATABASE Tyle\nCREATE Database Tyle\n---------------------------------------------------------------------\n----------------------------------------------------------------------\n--Script som kobler fra alt og alle som er tilkoblet\n--Deretter slettes databasen\nUSE [master];\nDECLARE @kill varchar(8000) = '';\nSELECT @kill = @kill + 'kill ' + CONVERT(varchar(5), session_id) + ';'\nFROM sys.dm_exec_sessions\nWHERE database_id = db_id('MimirorgAuthentication')\nEXEC(@kill);\nDROP DATABASE MimirorgAuthentication\nCREATE Database MimirorgAuthentication\n---------------------------------------------------------------------\n----------------------------------------------------------------------\n--Script som kobler fra alt og alle som er tilkoblet\n--Deretter slettes databasen\nUSE [master];\nDECLARE @kill varchar(8000) = '';\nSELECT @kill = @kill + 'kill ' + CONVERT(varchar(5), session_id) + ';'\nFROM sys.dm_exec_sessions\nWHERE database_id = db_id('ModelBuilder')\nEXEC(@kill);\nDROP DATABASE ModelBuilder\nCREATE Database ModelBuilder\n---------------------------------------------------------------------\n--USE master\n--GO\n--xp_readerrorlog 0, 1, N'Server is listening on' \n--GO\n"})})]})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>r});var t=s(7294);const i={},l=t.createContext(i);function r(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);