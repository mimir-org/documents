"use strict";(self.webpackChunkdocusaurus_docs=self.webpackChunkdocusaurus_docs||[]).push([[216],{2956:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var t=i(5893),o=i(1151);const r={title:"Setup",sidebar_position:2},l=void 0,s={id:"Mimir/setup",title:"Setup",description:"Mimir is currently not running/compatible with latest version of Tyle backend (Mimirorg.Authentication). Due to Mimirs",source:"@site/docs/Mimir/setup.md",sourceDirName:"Mimir",slug:"/Mimir/setup",permalink:"/documents/docs/Mimir/setup",draft:!1,unlisted:!1,editUrl:"https://github.com/mimir-org/documents/tree/main/docs/Mimir/setup.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Setup",sidebar_position:2},sidebar:"mimirDocs",previous:{title:"Introduction",permalink:"/documents/docs/Mimir/intro"},next:{title:"Current state of the code base",permalink:"/documents/docs/Mimir/status"}},a={},c=[{value:"Where Can I Find the Code?",id:"where-can-i-find-the-code",level:2},{value:"Setup",id:"setup",level:2},{value:"Database",id:"database",level:3},{value:"Applications",id:"applications",level:3},{value:"App settings",id:"app-settings",level:4},{value:"Run locally",id:"run-locally",level:4},{value:"After setup is complete",id:"after-setup-is-complete",level:2},{value:"Disable SSO logon",id:"disable-sso-logon",level:3},{value:"Mimir frontend and Yalc",id:"mimir-frontend-and-yalc",level:3},{value:"1. Install Yalc",id:"1-install-yalc",level:4},{value:"2. Publish the Component Library to Yalc",id:"2-publish-the-component-library-to-yalc",level:4},{value:"3. Add the Component Library to the Mimir Project",id:"3-add-the-component-library-to-the-mimir-project",level:4},{value:"4. Link the Component Library (Optional)",id:"4-link-the-component-library-optional",level:4},{value:"5. Push Updates (Optional)",id:"5-push-updates-optional",level:4},{value:"6. Remove the Component Library (Optional)",id:"6-remove-the-component-library-optional",level:4},{value:"7. Update the Component Library (Optional)",id:"7-update-the-component-library-optional",level:4}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.admonition,{title:"note",type:"caution",children:(0,t.jsx)(n.p,{children:"Mimir is currently not running/compatible with latest version of Tyle backend (Mimirorg.Authentication). Due to Mimirs\ntransitional\nstate and old IMF model.\nTherefore, parts of this installation guide will be deprecated."})}),"\n",(0,t.jsx)(n.h2,{id:"where-can-i-find-the-code",children:"Where Can I Find the Code?"}),"\n",(0,t.jsxs)(n.p,{children:["The code for Mimir, Tyle and the component-library can be found here ",(0,t.jsx)(n.a,{href:"https://github.com/mimir-org",children:"https://github.com/mimir-org"})," under the mimir-org\nrepository. The project can be\ncloned\nto your machine with ",(0,t.jsx)(n.code,{children:"git@github.com:mimir-org/<repository>.git"})," via SSH or ",(0,t.jsx)(n.code,{children:"gh repo clone mimir-org/<repository>"}),"\nwith ",(0,t.jsx)(n.a,{href:"https://cli.github.com/",children:"GitHub CLI"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"git clone git@github.com:mimir-org/mimir.git\n"})}),"\n",(0,t.jsx)(n.p,{children:"The file structure after cloning the repos could look something like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\ud83d\udcc1 mimirorg (this can be renamed to whatever you want)\n\u251c\u2500\u2500 \ud83d\udcc1 component-library\n\u2502   \u2514\u2500\u2500 \ud83d\udcc1 etc\n\u251c\u2500\u2500 \ud83d\udcc1 mimir\n\u2502   \u2514\u2500\u2500 \ud83d\udcc1 etc\n\u2514\u2500\u2500 \ud83d\udcc1 tyle\n    \u2514\u2500\u2500 \ud83d\udcc1 etc\n"})}),"\n",(0,t.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,t.jsx)(n.h3,{id:"database",children:"Database"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Mimir database is named ModelBuilder"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Download and install ",(0,t.jsx)(n.a,{href:"https://www.docker.com/",children:"Docker"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Create a new .yaml file and paste the following code."}),"\n"]}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:"docker-compose.yaml"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"version: \"3.8\"\n\nservices:\n  mssql:\n    image: \"mcr.microsoft.com/mssql/server:2017-CU8-ubuntu\"\n    hostname: 'mssql'\n    container_name: mssql\n    ports:\n      - '127.0.0.1:1433:1433'\n    volumes:\n      - mssql:/var/opt/mssql\n    environment:\n      - ACCEPT_EULA=Y\n      - MSSQL_SA_PASSWORD=P4ssw0rd1\n      - MSSQL_PID=Standard\n    networks:\n      - type_library_network\n    restart: unless-stopped\n\nvolumes:\n  mssql:\n    driver: local\n\nnetworks:\n  type_library_network:\n    driver: bridge\n"})})]}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Place this yaml file as shown below:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\ud83d\udcc1 mimirorg (this can be renamed to whatever you want)\n\u251c\u2500\u2500 \ud83d\udcc1 component-library\n\u2502   \u2514\u2500\u2500 \ud83d\udcc1 etc\n\u251c\u2500\u2500 \ud83d\udcc1 mimir\n\u2502   \u2514\u2500\u2500 \ud83d\udcc1 etc\n\u251c\u2500\u2500 \ud83d\udcc1 tyle\n\u2502   \u2514\u2500\u2500 \ud83d\udcc1 etc\n\u2514\u2500\u2500 \ud83d\udc0b docker-compose.yaml\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsx)(n.li,{children:"Then run the docker-compose file from the command line. Use docker-compose up -d from the folder where the file is\nlocated."}),"\n",(0,t.jsx)(n.li,{children:"Once it is up and running, you should be able to access the database using our database management\napplication of choice:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"- DataSource=mssql\n- Host=localhost\n- Port=1433\n- User=sa\n- Password=P4ssw0rd1\n"})}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:"Docker container list"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'CONTAINER ID   IMAGE                                            COMMAND                   CREATED         STATUS         PORTS                           NAMES\nd914b6d4d538   mcr.microsoft.com/mssql/server:2017-CU8-ubuntu   "/opt/mssql/bin/sqls\u2026"    9 seconds ago   Up 7 seconds   127.0.0.1:1433->1433/tcp        mssql\n'})})]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["If you are unfamiliar using docker command line tool. An option is to use\nthe ",(0,t.jsx)(n.a,{href:"https://www.docker.com/products/docker-desktop/",children:"docker desktop application"})," to manage docker containers."]})}),"\n",(0,t.jsx)(n.h3,{id:"applications",children:"Applications"}),"\n",(0,t.jsx)(n.p,{children:"Mimir depends on Tyle`s Mimirorg.Authentication so Tyle server needs to run in order to run both Mimir server and\nclient."}),"\n",(0,t.jsx)(n.h4,{id:"app-settings",children:"App settings"}),"\n",(0,t.jsxs)(n.p,{children:["Before we can run mimir server you need to create a local app settings file. Because of gitignore this file need to be\nnamed ",(0,t.jsx)(n.strong,{children:"appsettings.local.json"}),". Use the existing appsettings.json file combined with the environment variables section\nin the ",(0,t.jsx)(n.a,{href:"/documents/docs/Mimir/intro",children:"introduction page"}),". This step must also be done for tyle server, for more information see\nthe ",(0,t.jsx)(n.a,{href:"../Tyle/setup",children:"tyle setup guide"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Path to where the file should be created:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"src/service/ModelBuilder.Api/appsettings.local.json"})}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"run-locally",children:"Run locally"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Mimir server and Tyle server are ",(0,t.jsx)(n.a,{href:"https://dotnet.microsoft.com/en-us/",children:".NET"})," applications, so you need to build them\nbefore you can run them. This can be done via the IDE or using the command line as shown below. The ",(0,t.jsx)(n.code,{children:"dotnet run"}),"\ncommand builds and runs the applications."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"dotnet run <project name>\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:["Mimir client is a ",(0,t.jsx)(n.a,{href:"https://react.dev/",children:"React"})," application using NPM. So navigate to the client folder and run this\ncommand to install all node moduels required:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm i\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Then you run the build command followed by the start command to launch the application."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run build\nnpm run start\n"})}),"\n",(0,t.jsx)(n.h2,{id:"after-setup-is-complete",children:"After setup is complete"}),"\n",(0,t.jsx)(n.h3,{id:"disable-sso-logon",children:"Disable SSO logon"}),"\n",(0,t.jsxs)(n.p,{children:["To disable SSO for local development navigate to the .env file path: ",(0,t.jsx)(n.code,{children:"src/client/.env"}),". And set ",(0,t.jsx)(n.code,{children:"REACT_APP_SILENT=true"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"mimir-frontend-and-yalc",children:"Mimir frontend and Yalc"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://github.com/wclr/yalc",children:"https://github.com/wclr/yalc"})}),"\n",(0,t.jsx)(n.p,{children:"If you don't want to reference your local copy of the component library directly in your package.json you can use Yalc.\nYalc is a way to connect npm package development with the dev environment. It allows us to develop components in the\ncomponent-library and dynamically update them locally so that you don't have to release a new package on npm for every\ncode change."}),"\n",(0,t.jsx)(n.h4,{id:"1-install-yalc",children:"1. Install Yalc"}),"\n",(0,t.jsx)(n.p,{children:"First, you need to install Yalc globally on your machine:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm install -g yalc\n"})}),"\n",(0,t.jsx)(n.h4,{id:"2-publish-the-component-library-to-yalc",children:"2. Publish the Component Library to Yalc"}),"\n",(0,t.jsx)(n.p,{children:'Navigate to the "component-library" directory and publish the package to Yalc\'s local store:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd path/to/component-library\nyalc publish\n"})}),"\n",(0,t.jsx)(n.h4,{id:"3-add-the-component-library-to-the-mimir-project",children:"3. Add the Component Library to the Mimir Project"}),"\n",(0,t.jsx)(n.p,{children:'Now, navigate to the "mimir" project directory and add the "component-library" package using Yalc:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd path/to/mimir\nyalc add component-library\n"})}),"\n",(0,t.jsx)(n.h4,{id:"4-link-the-component-library-optional",children:"4. Link the Component Library (Optional)"}),"\n",(0,t.jsxs)(n.p,{children:['If you want to reflect the changes in the "component-library" instantly in the "mimir" project, you can use\nthe ',(0,t.jsx)(n.code,{children:"yalc link"})," command:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd path/to/component-library\nyalc link mimir\n"})}),"\n",(0,t.jsx)(n.h4,{id:"5-push-updates-optional",children:"5. Push Updates (Optional)"}),"\n",(0,t.jsx)(n.p,{children:'Whenever you make changes to the "component-library," you can push the updates to the "mimir" project using:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"yalc push\n"})}),"\n",(0,t.jsx)(n.h4,{id:"6-remove-the-component-library-optional",children:"6. Remove the Component Library (Optional)"}),"\n",(0,t.jsx)(n.p,{children:'If you want to remove the "component-library" from the "mimir" project and revert to the NPM version, you can use:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd path/to/mimir\nyalc remove component-library\n"})}),"\n",(0,t.jsx)(n.h4,{id:"7-update-the-component-library-optional",children:"7. Update the Component Library (Optional)"}),"\n",(0,t.jsx)(n.p,{children:'To update the "component-library" in the "mimir" project with the latest version from Yalc\'s local store, you can use:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd path/to/mimir\nyalc update component-library\n"})}),"\n",(0,t.jsx)(n.h1,{id:"i-need-to-clean-up-my-local-database-how-can-i-do-this",children:"I need to clean up my local database, how can I do this?"}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.p,{children:"ModelBuilder kill script"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"---------------------------------------------------------------------\n----------------------------------------------------------------------\n--Script som kobler fra alt og alle som er tilkoblet\n--Deretter slettes databasen\nUSE [master];\nDECLARE @kill varchar(8000) = '';\nSELECT @kill = @kill + 'kill ' + CONVERT(varchar(5), session_id) + ';'\nFROM sys.dm_exec_sessions\nWHERE database_id = db_id('ModelBuilder')\nEXEC(@kill);\nDROP DATABASE ModelBuilder\nCREATE Database ModelBuilder\nINSERT INTO [ModelBuilder].[dbo].[CollaborationPartner] VALUES ('Aibel', 'aibel.com', 0, 'rdf.aibel.com');\n---------------------------------------------------------------------\n--USE master\n--GO\n--xp_readerrorlog 0, 1, N'Server is listening on' \n--GO\n"})})]})]})}function h(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>s,a:()=>l});var t=i(7294);const o={},r=t.createContext(o);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);