"use strict";(self.webpackChunkdocusaurus_docs=self.webpackChunkdocusaurus_docs||[]).push([[790],{3905:(t,e,a)=>{a.d(e,{Zo:()=>u,kt:()=>b});var r=a(7294);function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e){if(null==t)return{};var a,r,i=function(t,e){if(null==t)return{};var a,r,i={},n=Object.keys(t);for(r=0;r<n.length;r++)a=n[r],e.indexOf(a)>=0||(i[a]=t[a]);return i}(t,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(r=0;r<n.length;r++)a=n[r],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(i[a]=t[a])}return i}var c=r.createContext({}),l=function(t){var e=r.useContext(c),a=e;return t&&(a="function"==typeof t?t(e):o(o({},e),t)),a},u=function(t){var e=l(t.components);return r.createElement(c.Provider,{value:e},t.children)},p="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},d=r.forwardRef((function(t,e){var a=t.components,i=t.mdxType,n=t.originalType,c=t.parentName,u=s(t,["components","mdxType","originalType","parentName"]),p=l(a),d=i,b=p["".concat(c,".").concat(d)]||p[d]||m[d]||n;return a?r.createElement(b,o(o({ref:e},u),{},{components:a})):r.createElement(b,o({ref:e},u))}));function b(t,e){var a=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var n=a.length,o=new Array(n);o[0]=d;var s={};for(var c in e)hasOwnProperty.call(e,c)&&(s[c]=e[c]);s.originalType=t,s[p]="string"==typeof t?t:i,o[1]=s;for(var l=2;l<n;l++)o[l]=a[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},563:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>n,metadata:()=>s,toc:()=>l});var r=a(7462),i=(a(7294),a(3905));const n={sidebar_position:4},o="React redux pitfalls",s={unversionedId:"Mimir/Overview/react-redux-pitfalls",id:"Mimir/Overview/react-redux-pitfalls",title:"React redux pitfalls",description:"State mutation",source:"@site/docs/Mimir/Overview/react-redux-pitfalls.md",sourceDirName:"Mimir/Overview",slug:"/Mimir/Overview/react-redux-pitfalls",permalink:"/documents/docs/Mimir/Overview/react-redux-pitfalls",draft:!1,editUrl:"https://github.com/mimir-org/documents/tree/main/docusaurus-docs/docs/Mimir/Overview/react-redux-pitfalls.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"mimirDocs",previous:{title:"Extend functionality - Detailed",permalink:"/documents/docs/Mimir/Overview/react-redux-detailed"},next:{title:"Custom hooks",permalink:"/documents/docs/category/custom-hooks"}},c={},l=[{value:"State mutation",id:"state-mutation",level:2},{value:"Examples of state mutation in Mimir",id:"examples-of-state-mutation-in-mimir",level:2},{value:"Fixes",id:"fixes",level:3},{value:"AdminTab.tsx",id:"admintabtsx",level:4},{value:"Direct mutation of <code>aspectObject</code>:",id:"direct-mutation-of-aspectobject",level:5},{value:"AttributeTab.tsx &amp; AttributeItem.tsx",id:"attributetabtsx--attributeitemtsx",level:4},{value:"Direct mutation of <code>attributeToUpdate</code>:",id:"direct-mutation-of-attributetoupdate",level:5}],u={toc:l},p="wrapper";function m(t){let{components:e,...a}=t;return(0,i.kt)(p,(0,r.Z)({},u,a,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"react-redux-pitfalls"},"React redux pitfalls"),(0,i.kt)("h2",{id:"state-mutation"},"State mutation"),(0,i.kt)("p",null,"When updating the state in a reducer, it's important to remember that the state should be treated as immutable. Modifying the state directly can lead to unexpected behaviour and make it difficult to track changes and understand the state flow.\nHere's an example of an incorrect state mutation within a reducer:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Incorrect Approach\nconst myReducer = (state, action) => {\n  state.someProperty = action.payload; // Directly mutating the state object\n  return state;\n};\n")),(0,i.kt)("p",null,"Instead, you should create a new state object or clone the existing state and make modifications on the new object. This ensures that the original state remains unchanged.\nHere's the recommended approach:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Correct Approach\nconst myReducer = (state, action) => {\n  return {\n    ...state, // Cloning the existing state\n    someProperty: action.payload // Modifying the cloned state\n  };\n};\n")),(0,i.kt)("p",null,"By correctly handling state mutations, you maintain the immutability principle, which is crucial for the predictability and maintainability of your Redux state."),(0,i.kt)("h2",{id:"examples-of-state-mutation-in-mimir"},"Examples of state mutation in Mimir"),(0,i.kt)("p",null,"Delete this file when proplems are fixed."),(0,i.kt)("p",null,"I took the liberty of merging in state mutations to the dev branch, this way you can fix them as a trial. I have also included a working solution below, but I would like you to try and find the errors before you look a the solution."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/mimir-org/mimir/blob/dev/src/client/src/components/modules/inspector/tabs/AdminTab.tsx"},"AdminTab.tsx")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/mimir-org/mimir/blob/dev/src/client/src/components/modules/inspector/tabs/AttributeTab.tsx"},"AttributeTab.tsx")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/mimir-org/mimir/blob/dev/src/client/src/components/modules/inspector/tabs/TerminalTab.tsx"},"TerminalTab.tsx")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/mimir-org/mimir/blob/dev/src/client/src/components/modules/inspector/tabComponents/AttributeItem.tsx"},"AttributeItem.tsx"))),(0,i.kt)("h3",{id:"fixes"},"Fixes"),(0,i.kt)("h4",{id:"admintabtsx"},"AdminTab.tsx"),(0,i.kt)("h5",{id:"direct-mutation-of-aspectobject"},"Direct mutation of ",(0,i.kt)("inlineCode",{parentName:"h5"},"aspectObject"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"const onSubmit = () => {\n  aspectObject.label = labelValue;  // Direct mutation\n  aspectObject.description = descriptionValue;  // Direct mutation\n  dispatch(updateProject({ ...projectState }));\n};\n")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"View fix"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const onSubmit = () => {\n  const updatedAspectObject = {\n    ...aspectObject,\n    label: labelValue,\n    description: descriptionValue,\n  };\n  dispatch(updateProject({ ...projectState, aspectObject: updatedAspectObject }));\n};\n"))),(0,i.kt)("h4",{id:"attributetabtsx--attributeitemtsx"},"AttributeTab.tsx & AttributeItem.tsx"),(0,i.kt)("h5",{id:"direct-mutation-of-attributetoupdate"},"Direct mutation of ",(0,i.kt)("inlineCode",{parentName:"h5"},"attributeToUpdate"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"const handleInputChange = (id: string, value: string) => {\n  const attributeToUpdate = attributes.find((attr) => attr.id === id);\n  if (attributeToUpdate) {\n    attributeToUpdate.value = value;  // Direct mutation\n    dispatch(updateProject({ ...projectState }));\n  }\n};\n")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"View fix"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"const handleInputChange = (id: string, value: string) => {\n  const updatedAttributes = attributes.map((attr) =>\n    attr.id === id ? { ...attr, value } : attr\n  );\n  dispatch(updateProject({ ...projectState, attributes: updatedAttributes }));\n};\n"))),(0,i.kt)("p",null,"These fixes ensure that the state is not directly mutated, adhering to the principles of immutability in Redux."),(0,i.kt)("p",null,"Would you like to know more about any specific part?"))}m.isMDXComponent=!0}}]);